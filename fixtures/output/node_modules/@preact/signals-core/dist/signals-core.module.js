function t(t,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var n,i=null,r=null,u=new Set,o=/*#__PURE__*/function(){function i(t){this._s=new Set,this._d=new Set,this._p=0,this._v=void 0,this._r=!1,this._q=!1,this.t=!1,this._c=!1,this._v=t}var o,c,a=i.prototype;return a.toString=function(){return""+this.value},a.peek=function(){return(!this.t||this._p>0)&&l(this),this._v},a._=function(){var t=this,i=n,r=u;return n=this,u=this._d,this._d=new Set,function(o,e){o&&t._s.forEach(f),u.forEach(e?function(n){return s(t,n)}:function(n){return h(t,n)}),u.clear(),u=r,n=i}},a.subscribe=function(t){var n=this;return y(function(){return t(n.value)})},a._u=function(){},o=i,(c=[{key:"value",get:function(){return(!this.t||this._p>0)&&l(this),n?(this._s.add(n),n._d.add(this),u.delete(this),this._v):this._v},set:function(t){var n=this;if(this._r)throw Error("Computed signals are readonly");this._v!==t&&(this._v=t,S(function(){r.add(n),0===n._p&&e(n)}))}}])&&t(o.prototype,c),Object.defineProperty(o,"prototype",{writable:!1}),i}();function e(t){0==t._p++&&t._s.forEach(e)}function f(t){!t._q&&t._p>0&&0==--t._p&&t._s.forEach(f)}function c(t){t.forEach(function(t){if(t._p>1)return--t._p;var n=!0;if(t._d.forEach(function(t){t._p>0&&(n=!1)}),n&&t._p>0&&0==--t._p){if(t._c)throw Error("Cycle detected");t._q=!1,t._c=!0,t._u(),t._c=!1,c(t._s)}})}function h(t,n){t.t=!0,t._d.add(n),n._s.add(t)}function s(t,n){t._d.delete(n),n._s.delete(t),0===n._s.size&&(n.t=!1,n._d.forEach(function(t){return s(n,t)}))}var a=[];function v(t){if(r&&r.delete(t),t._p=0,t._u(),i){var n=i;throw i=null,n}t._s.forEach(function(t){t._p>0&&(t._p>1&&t._p--,a.push(t))})}function l(t){t.t=!0,v(t)}function w(t){return new o(t)}function d(t){var n=new o(void 0);return n._r=!0,n._u=function(){var r=n._();try{var u=t(),o=n._v===u;o||n._s.forEach(function(t){return t._q=!0}),r(o,!0),n._v=u}catch(t){i||(i=t),r(!0,!1)}},n}function y(t){var n=d(function(){return S(t)});return l(n),function(){return n._()(!0,!0)}}function S(t){if(null!==r)return t();var n=new Set;r=n;try{return t()}finally{for(var u;void 0!==(u=a.pop());)n.add(u);if(r=null,c(n),i){var o=i;throw i=null,o}}}export{o as Signal,S as batch,d as computed,y as effect,w as signal};//# sourceMappingURL=signals-core.module.js.map
