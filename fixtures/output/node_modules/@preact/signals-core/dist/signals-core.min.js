!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((t||self).preactSignalsCore={})}(this,function(t){function n(t,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i,r=null,e=null,u=new Set,o=/*#__PURE__*/function(){function t(t){this._s=new Set,this._d=new Set,this._p=0,this._v=void 0,this._r=!1,this._q=!1,this.t=!1,this._c=!1,this._v=t}var r,o,s=t.prototype;return s.toString=function(){return""+this.value},s.peek=function(){return(!this.t||this._p>0)&&v(this),this._v},s._=function(){var t=this,n=i,r=u;return i=this,u=this._d,this._d=new Set,function(e,o){e&&t._s.forEach(c),u.forEach(o?function(n){return h(t,n)}:function(n){return r=n,(i=t).t=!0,i._d.add(r),void r._s.add(i);var i,r}),u.clear(),u=r,i=n}},s.subscribe=function(t){var n=this;return w(function(){return t(n.value)})},s._u=function(){},r=t,(o=[{key:"value",get:function(){return(!this.t||this._p>0)&&v(this),i?(this._s.add(i),i._d.add(this),u.delete(this),this._v):this._v},set:function(t){var n=this;if(this._r)throw Error("Computed signals are readonly");this._v!==t&&(this._v=t,y(function(){e.add(n),0===n._p&&f(n)}))}}])&&n(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),t}();function f(t){0==t._p++&&t._s.forEach(f)}function c(t){!t._q&&t._p>0&&0==--t._p&&t._s.forEach(c)}function s(t){t.forEach(function(t){if(t._p>1)return--t._p;var n=!0;if(t._d.forEach(function(t){t._p>0&&(n=!1)}),n&&t._p>0&&0==--t._p){if(t._c)throw Error("Cycle detected");t._q=!1,t._c=!0,t._u(),t._c=!1,s(t._s)}})}function h(t,n){t._d.delete(n),n._s.delete(t),0===n._s.size&&(n.t=!1,n._d.forEach(function(t){return h(n,t)}))}var a=[];function l(t){if(e&&e.delete(t),t._p=0,t._u(),r){var n=r;throw r=null,n}t._s.forEach(function(t){t._p>0&&(t._p>1&&t._p--,a.push(t))})}function v(t){t.t=!0,l(t)}function d(t){var n=new o(void 0);return n._r=!0,n._u=function(){var i=n._();try{var e=t(),u=n._v===e;u||n._s.forEach(function(t){return t._q=!0}),i(u,!0),n._v=e}catch(t){r||(r=t),i(!0,!1)}},n}function w(t){var n=d(function(){return y(t)});return v(n),function(){return n._()(!0,!0)}}function y(t){if(null!==e)return t();var n=new Set;e=n;try{return t()}finally{for(var i;void 0!==(i=a.pop());)n.add(i);if(e=null,s(n),r){var u=r;throw r=null,u}}}t.Signal=o,t.batch=y,t.computed=d,t.effect=w,t.signal=function(t){return new o(t)}});//# sourceMappingURL=signals-core.min.js.map
